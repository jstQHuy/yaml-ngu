"""AutoPentester prompt primitives (adapted).

This module copies the *useful* prompt building blocks from the reference
AutoPentester/PentestGPT implementation, so we can reuse them without importing
their entire codebase.

We only keep primitives that improve robustness for PentestAgent's pipeline:
  - command extraction (free-form -> tool + commands)
  - results verifier (fix incomplete / syntactically wrong commands)
  - input parsing init (summarize tool output)

Important:
  - These prompts are used as *helpers* under strict policy guards.
  - Actual command execution is still constrained by ExecGuard allow/deny rules.
"""

from __future__ import annotations


# From AutoPentester's `prompt_class.py` (user-provided).
COMMAND_EXTRACTOR_INIT: str = (
    "You will be given a text which explains a cybersecurity task. "
    "Extract the cyber security tool and the command/ commands which can run on that tool. "
    "Output the tool name in the first line and commands in subsequent lines. "
    "You should not include any half commands or arguments. One command should take one line.\n"
    "Do not provide any other explanation. The tool name should be in the lowercase."
)


RESULTS_VERIFIER_INIT: str = (
    "You are a cybersecuriy experts. You will be given a set of commands and the results of those commands. "
    "You have to check the followings:\n"
    "1. Whether the commands are complete. That means all the arguments are filled and there are no variables.\n"
    "2. Whether the syntax of the commands are correct\n"
    "3. Whether they have run correctly and given the expected outcomes.\n\n"
    "If all the above conditions are satisfied, Output a single word \"Pass\". Otherwise;\n"
    "If the commands are not complete, try to complete them and generate complete commands using the resources provided to you.\n"
    "If the syntaxes are incorrect or there are issues in the runtime, adjust the commands using the suggestions."
)


INPUT_PARSING_INIT: str = (
    "You're required to work as an assistant to a cybersecurity penetration tester in a certified penetration testing experiment. "
    "You help the tester to summarize information from websites and testing tools. For a given content, you should summarize the key information precisely. "
    "In particular,\n"
    "1. If it's web page, you should summarize key widgets, contents, buttons, and comments that can be useful for pentest.\n"
    "2. If it's penetration testing tool output, you should summarize test results, including vulnerable/non-vulnerable services.\n"
    "3. You should keep both finding's field name and value. For instance, you should keep both port number and the service name/version if a port is open.\n"
    "4. You only summarize. You do not conclude or make assumptions.\n"
    "Your output will be provided to another large language model, so the result should be short and precise for token limit reason."
)
